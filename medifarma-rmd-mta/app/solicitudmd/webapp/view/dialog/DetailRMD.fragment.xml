<core:FragmentDefinition 
    xmlns="sap.m" 
    xmlns:core="sap.ui.core" 
    xmlns:form="sap.ui.layout.form"
    xmlns:u="sap.ui.unified">
	<Dialog title="{i18n>titleDetailRMD} [{modelGeneral>/lineaSeleccionada/descripcion}]" class="sapUiContentPadding sapUiSizeCompact" contentWidth="65%" draggable="true">
		<content>
            <form:Form>
                <form:formContainers>
                    <form:FormContainer>
                        <form:formElements>
                            <form:FormElement visible="{=${modelGeneral>/lineaSeleccionada/estadoIdRmd/iMaestraId}===470? true : false}">
                                <form:label>
                                    <Label text="Motivo Rechazo" vAlign="Middle" design="Bold" width="100%" textAlign="Begin" textDirection="Inherit"/>
                                </form:label>
                                <form:fields>
                                    <Input value="{modelGeneral>/lineaSeleccionada/motivoRechazo}" placeholder="Motivo Rechazo" editable="false"/>
                                </form:fields>
                            </form:FormElement>
                            <form:FormElement visible="{=${modelGeneral>/aFilters/aplicacionId} === '3b5fc15f-3dcb-4c0f-8927-8ba26964da38'}">
                                <form:label>
                                    <Label text="{i18n>lblCodigo}" vAlign="Middle" design="Bold" width="100%" required="true" textAlign="Begin" textDirection="Inherit"/>
                                </form:label>
                                <form:fields>
                                    <Input value="{modelGeneral>/lineaSeleccionada/codigoSolicitud}" placeholder="{i18n>phlblCodigo}" editable="false"/>
                                </form:fields>
                            </form:FormElement>
                            <form:FormElement visible="{=${modelGeneral>/aFilters/aplicacionId} === '295fd633-d654-49b6-86a0-674611a3b783'}">
                                <form:label>
                                    <Label text="{i18n>lblCodigo}" vAlign="Middle" design="Bold" width="100%" required="true" textAlign="Begin" textDirection="Inherit"/>
                                </form:label>
                                <form:fields>
                                    <Input value="{modelGeneral>/lineaSeleccionada/codigo}" placeholder="{i18n>phlblCodigo}" editable="false"/>
                                </form:fields>
                            </form:FormElement>
                            <form:FormElement >
                                <form:label>
                                    <Label text="{i18n>lblName}" vAlign="Middle" design="Bold" width="100%" required="true" textAlign="Begin" textDirection="Inherit"/>
                                </form:label>
                                <form:fields>
                                    <Input value="{modelGeneral>/lineaSeleccionada/descripcion}" placeholder="{i18n>phlblName}" editable="{=${modelGeneral>/lineaSeleccionada/estadoIdRmd/iMaestraId}===470 &amp;&amp; ${modelGeneral>/lineaSeleccionada/tipoMD} === 'Nuevo RMD' ? true : false}"/>
                                </form:fields>
                            </form:FormElement>
                            <form:FormElement>
                                <form:label>
                                    <Label text="{i18n>lblPlant}" vAlign="Middle" design="Bold" width="100%" required="true" textAlign="Begin" textDirection="Inherit"/>
                                </form:label>
                                <form:fields>
                                    <ComboBox items="{
                                        path : 'mainModel>/MAESTRA',
                                        filters: [{
                                                path: 'oMaestraTipo_maestraTipoId',
                                                operator: 'EQ',
                                                value1: '18'
                                            }]
                                            }" 
                                        placeholder="{i18n>phlblPlant}" selectedKey="{modelGeneral>/lineaSeleccionada/sucursalId_iMaestraId}"
                                        showSecondaryValues="true" filterSecondaryValues="true" editable="{=${modelGeneral>/lineaSeleccionada/estadoIdRmd/iMaestraId}===470 &amp;&amp; ${modelGeneral>/lineaSeleccionada/tipoMD} === 'Nuevo RMD' ? true : false}">
                                        <core:ListItem key="{mainModel>iMaestraId}" text="{mainModel>descripcion}" additionalText="{mainModel>codigo}"/>
                                    </ComboBox>
                                </form:fields>
                            </form:FormElement>
                            <form:FormElement>
                                <form:label>
                                    <Label text="{i18n>lblSection}" vAlign="Middle" design="Bold" width="100%" required="true" textAlign="Begin" textDirection="Inherit"/>
                                </form:label>
                                <form:fields>
                                    <ComboBox items="{modelGeneral>/aListaSecciones}" placeholder="{i18n>phlblSection}" selectedKey="{modelGeneral>/lineaSeleccionada/areaRmdTxt}"
                                        showSecondaryValues="true" filterSecondaryValues="true" editable="{=${modelGeneral>/lineaSeleccionada/estadoIdRmd/iMaestraId}===470 &amp;&amp; ${modelGeneral>/aListaSecciones}.length > 0 &amp;&amp; ${modelGeneral>/lineaSeleccionada/tipoMD} === 'Nuevo RMD' ? true : false}">
                                        <core:ListItem key="{modelGeneral>Atwrt}" text="{modelGeneral>Atwrt}" additionalText="{modelGeneral>Atzhl}"/>
                                    </ComboBox>
                                </form:fields>
                            </form:FormElement>
                            <form:FormElement>
                                <form:label>
                                    <Label text="{i18n>lblReason}" vAlign="Middle" design="Bold" width="100%" required="true" textAlign="Begin" textDirection="Inherit"/>
                                </form:label>
                                <form:fields>
                                    <ComboBox items="{mainModel>/MOTIVO}" placeholder="{i18n>phlblReason}" selectedKey="{modelGeneral>/lineaSeleccionada/motivoId_motivoId}"
                                    showSecondaryValues="true" filterSecondaryValues="true" editable="{=${modelGeneral>/lineaSeleccionada/estadoIdRmd/iMaestraId}===470 || (${modelGeneral>/lineaSeleccionada/debeAprobar} &amp;&amp; ${modelGeneral>/lineaSeleccionada/estadoIdRmd/iMaestraId}===464 &amp;&amp; ${modelGeneral>/oInfoUsuario/funcionUsuario/aprobadorSolicitud}) ? true : false}">
                                    <core:ListItem key="{mainModel>motivoId}" text="{mainModel>descripcion}" additionalText="{mainModel>abreviatura}"/>
                                    </ComboBox>
                                </form:fields>
                            </form:FormElement>
                            <form:FormElement visible="{=${modelGeneral>/aFilters/aplicacionId} === '3b5fc15f-3dcb-4c0f-8927-8ba26964da38'}">
                                <form:label>
                                    <Label text="{i18n>lblObservation}" vAlign="Middle" design="Bold" width="100%" textAlign="Begin" textDirection="Inherit"/>
                                </form:label>
                                <form:fields>
                                    <Input value="{modelGeneral>/lineaSeleccionada/observacion}" placeholder="{i18n>phlblObservation}" editable="{=${modelGeneral>/lineaSeleccionada/estadoIdRmd/iMaestraId}===470? true : false}"/>
                                </form:fields>
                            </form:FormElement>
                            <form:FormElement>
                                <form:label>
                                    <Label text="{i18n>lblDestinations}" vAlign="Middle" design="Bold" width="100%" required="true" textAlign="Begin" textDirection="Inherit"/>
                                </form:label>
                                <form:fields>
                                    <MultiComboBox 
                                        items="{
                                            path: 'modelGeneral>/destinations',
                                            sorter: {
                                                path: 'modelGeneral>rol',
                                                descending: false,
                                                group: true
                                            }
                                        }"
                                        id="idDestinatariosEdit" selectedKeys="{modelGeneral>/destinatariosEdit}"
                                        showSecondaryValues="true" editable="{=${modelGeneral>/lineaSeleccionada/estadoIdProceso/iMaestraId} === 457 ||${modelGeneral>/lineaSeleccionada/estadoIdProceso/iMaestraId} === 458 ? true : false}">
                                        <core:ListItem key="{modelGeneral>usuarioId}" text="{modelGeneral>usuario} - {modelGeneral>nombre}"/>
                                    </MultiComboBox>
                                </form:fields>
                            </form:FormElement>
                            <form:FormElement>
                                <form:label>
                                    <Label text="Etapa" vAlign="Middle" design="Bold" width="100%" required="true" textAlign="Begin" textDirection="Inherit"/>
                                </form:label>
                                <form:fields>
                                    <ComboBox items="{modelGeneral>/aListaNiveles}" placeholder="Seleccione etapa" selectedKey="{modelGeneral>/lineaSeleccionada/nivelTxt}"
                                    showSecondaryValues="true" filterSecondaryValues="true" editable="{=${modelGeneral>/lineaSeleccionada/estadoIdRmd/iMaestraId}===470 &amp;&amp; ${modelGeneral>/lineaSeleccionada/tipoMD} === 'Nuevo RMD' ? true : false}">
                                    <core:ListItem key="{modelGeneral>Atwrt}" text="{modelGeneral>Atwrt}" additionalText="{modelGeneral>Atzhl}"/>
                                    </ComboBox>
                                </form:fields>
                            </form:FormElement>
                            <form:FormElement>
                                <form:label>
                                    <Label text="{i18n>lblAdjunt}" vAlign="Middle" design="Bold" width="100%" required="true" textAlign="Begin" textDirection="Inherit"/>
                                </form:label>
                                <form:fields>
                                    <Table items="{modelGeneral>/lineaSeleccionada/adjuntos}">
                                        <headerToolbar>
                                            <OverflowToolbar>
                                                <content>
                                                    <ToolbarSpacer />
                                                    <u:FileUploader id="fileUploader4" tooltip="{i18n>tltpAdjunt}" uploadOnChange="true" change="onSubirAdjuntoEdit" icon="sap-icon://upload" iconOnly="true" buttonOnly="true" visible="{=${modelGeneral>/lineaSeleccionada/estadoIdRmd/iMaestraId}===470? true : false}"/>
                                                </content>
                                            </OverflowToolbar>
                                        </headerToolbar>
                                        <columns>
                                            <Column width="3em">
                                                <Text text="" />
                                            </Column>
                                            <Column>
                                                <Text text="Nombre" />
                                            </Column>
                                            <Column hAlign="End" visible="{=${modelGeneral>/lineaSeleccionada/estadoIdRmd/iMaestraId}===470? true : false}">
                                                <Text text=""/>
                                            </Column>
                                        </columns>
                                        <items>
                                            <ColumnListItem>
                                                <cells>
                                                    <core:Icon src="sap-icon://pdf-attachment"/>
                                                    <Text text="{modelGeneral>Name}"/>
                                                    <Button icon="sap-icon://decline" type="Transparent" press="onEliminarAdjunto"/>
                                                </cells>
                                            </ColumnListItem>
                                        </items>
                                    </Table>
                                </form:fields>
                            </form:FormElement>
                            <form:FormElement visible="false">
                                <form:label>
                                    <Label text="Comparar Versiones" vAlign="Middle" design="Bold" width="100%"/>
                                </form:label>
                                <form:fields>
                                    <u:FileUploader id="1" change="onUploadComparar" icon="sap-icon://upload" iconOnly="true" buttonOnly="true"/>
                                    <u:FileUploader id="2" change="onUploadComparar" icon="sap-icon://upload" iconOnly="true" buttonOnly="true"/>
                                </form:fields>
                            </form:FormElement>
                            <form:FormElement visible="{=${modelGeneral>/lineaSeleccionada/estadoIdProceso/iMaestraId} === 461 ? true : false}">
                                <form:label>
                                    <Label text="Cargar Archivo MD" vAlign="Middle" design="Bold" width="100%"/>
                                </form:label>
                                <form:fields>
                                    <u:FileUploader id="3" change="onUploadMDAutorizado" icon="sap-icon://upload" iconOnly="true" buttonOnly="true"/>
                                </form:fields>
                            </form:FormElement>
                            
                        </form:formElements>
                    </form:FormContainer>
                </form:formContainers>
                <form:layout>
                <form:ResponsiveGridLayout adjustLabelSpan="false" columnsL="2" labelSpanL="3" columnsM="1" labelSpanM="2" labelSpanS="12"/>
                </form:layout>
            </form:Form>
		</content>
        <buttons>
            <Button text="Aprobar" press="onAprobarSolicitud" type="Accept" visible="{=${modelGeneral>/lineaSeleccionada/debeAprobar} &amp;&amp; ${modelGeneral>/oInfoUsuario/funcionUsuario/aprobadorSolicitud} &amp;&amp; ${modelGeneral>/lineaSeleccionada/estadoIdRmd/iMaestraId} === 464 ? true : false}"/>
            <Button text="Rechazar" press="onRejectDialog" type="Reject" visible="{=${modelGeneral>/lineaSeleccionada/debeAprobar} &amp;&amp; ${modelGeneral>/oInfoUsuario/funcionUsuario/aprobadorSolicitud} &amp;&amp; ${modelGeneral>/lineaSeleccionada/estadoIdRmd/iMaestraId} === 464 ? true : false}"/>
            <Button text="Aprobar" press="onAprobarSolicitud" type="Accept" visible="{=${modelGeneral>/lineaSeleccionada/debeAprobar} &amp;&amp; ${modelGeneral>/aFilters/aplicacionId} === '295fd633-d654-49b6-86a0-674611a3b783' ? true : false}"/>
            <Button text="Rechazar" press="onRejectDialog" type="Reject" visible="{=${modelGeneral>/lineaSeleccionada/debeAprobar} &amp;&amp; ${modelGeneral>/aFilters/aplicacionId} === '295fd633-d654-49b6-86a0-674611a3b783' ? true : false}"/>
            <Button text="Comparar" press="onSendCompareVersion" type="Transparent" visible="{=${modelGeneral>/lineaSeleccionada/estadoIdProceso/iMaestraId} === 461 ? true : false}"/>
            <Button text="Guardar" press="onGuardarSolicitud" type="Accept" visible="{=${modelGeneral>/lineaSeleccionada/estadoIdRmd/iMaestraId} === 470 ? true : false}"/>
            <Button text="Cancelar" press="onCancelarModifSolicitud"/>
        </buttons>
	</Dialog>
</core:FragmentDefinition>