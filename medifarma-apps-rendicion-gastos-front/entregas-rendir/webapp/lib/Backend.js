/*!
 * © 2021, Everis Peru
 */
sap.ui.define(["sap/base/Log","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(e,r,t){"use strict";const o={};o.initialize=function(e){this.eperUtilsModel=e};o.getParameters=function(o,s){return new Promise((a,n)=>{const i=[];const l=new r("Group1",t.EQ,s);i.push(new r("Application",t.EQ,o));if(s){i.push(l)}this.eperUtilsModel.read("/ParameterSet",{filters:i,success:(r,t,o)=>{e.info("[UTILS] Backend - getParameters - results length",r.results?r.results.length:0);a(r.results||[])},error:(r,t,o)=>{e.error(o);n(o)}})})};o.getSharepointToken=function(e){return new Promise((r,t)=>{this.eperUtilsModel.read(`/SharepointTokenSet('${e}')`,{success:e=>{if(e.Token){r(e.Token)}else{t()}},error:e=>{t(e)}})})};o.parseParameters=function(r,t){return new Promise((o,s)=>{const a={};t.applications.forEach(o=>{a[o]={};t[o].forEach(t=>{const n=r.filter(e=>e.Group1===o&&e.Field===t.key);if(t.array){if(t.highValue){a[o][t.key]=n.map(e=>({valueLow:e.ValueLow,valueHigh:e.ValueHigh}))}else{a[o][t.key]=n.map(e=>e.ValueLow)}}else if(n.length===0&&t.mandatory){e.error("[UTILS] Home.controller - parseParameters - Mandatory parameter not set",t.key);s("Parámetro obligatorio no encontrado:"+t.key)}else{a[o][t.key]=n[0].ValueLow}})});o(a)})};return o});