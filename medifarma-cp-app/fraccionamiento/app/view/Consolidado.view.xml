<mvc:View
	controllerName="mif.cp.fraccionamiento.controller.Consolidado"
	xmlns:mvc="sap.ui.core.mvc"
	xmlns="sap.m"
	xmlns:c="sap.ui.core"
	xmlns:t="sap.ui.table"
	displayBlock="true"
	height="100%"
	busyIndicatorDelay="0"
>
	<Page>
		<customHeader>
			<Toolbar>
				<content>
					<c:Fragment
						fragmentName="mif.cp.fraccionamiento.view.fragment.Header"
						type="XML"
					/>
				</content>
			</Toolbar>
		</customHeader>
		<footer>
			<OverflowToolbar>
				<ToolbarSpacer/>
				<Button
					text="{i18n>verDetalle}"
					icon="sap-icon://detail-view"
					enabled="{=${localModel>/Online}}"
					press="onVerDetallePress"
					class="sapMBtnLarge"
				/>
				<Button
					text="Actualizar Estados"
					icon="sap-icon://detail-view"
					visible="false"
					enabled="{=${localModel>/Online}}"
					press="onActualizarEstadoPress"
					class="sapMBtnLarge"
				/>
				<Button
					text="{i18n>actualizar}"
					icon="sap-icon://refresh"
					enabled="{=${localModel>/Online}}"
					press="onActualizarPress"
					class="sapMBtnLarge"
				/>
				<ToolbarSpacer/>
				<Button
					text="{i18n>regresar}"
					icon="sap-icon://undo"
					press="onRegresarPress"
					class="sapMBtnLarge"
				/>
			</OverflowToolbar>
		</footer>
		<t:Table
			rows="{
				path: 'localModel>/Consolidado',
				sorter: {
					path: 'fraccion'
				}
			}"
			id="tblConsolidado"
			selectionMode="Single"
			rowSelectionChange="onConsolidadoRowSelected"
			selectionBehavior="Row"
			visibleRowCount="{=${localModel>/Consolidado}.length}"
			ariaLabelledBy="title"
		>
			<t:extension>
				<OverflowToolbar>
					<VBox>
						<HBox>
							<Label text="{i18n>listadoConsolidadoOrdenes}"/>
							<Label
								class="sapUiSmallMarginBegin"
								text="{i18n>numeroGrupo}: {localModel>/Consolidado_GrupoOrden/codigo}"
							/>
						</HBox>
						<HBox>
							<Label text="Sala: "/>
							<Label
								class="sapUiSmallMarginBegin"
								text="{localModel>/SalaPesaje}"
							/>
						</HBox>
					</VBox>
					
					
					<ToolbarSpacer/>
					<Label text="{i18n>estado}:"/>
					<Select
						change="onEstadoChange"
						width="300px"
						selectedKey="{localModel>/Consolidado_estado}"
						items="{
							path: 'localModel>/EstadosConsolidado',
							sorter: {
								path: 'contenido'
							}
						}"
					>
						<c:Item
							key="{localModel>iMaestraId}"
							text="{localModel>contenido}"
						/>
					</Select>
				</OverflowToolbar>
			</t:extension>
			<t:columns>
				<t:Column width="4rem">
					<Label text="{i18n>rep}"/>
					<t:template>
						<Text
							text="{localModel>tieneOtraSala}"
							wrapping="false"
						/>
					</t:template>
				</t:Column>
				<t:Column width="6rem">
					<Label text="Agotar"/>
					<t:template>
						<Text
							text="{= ${localModel>agotar} === 'X' ? 'SI' : 'NO'}"
							wrapping="false"
						/>
					</t:template>
				</t:Column>
				<t:Column width="11rem">
					<Label text="{i18n>codInsumo}"/>
					<t:template>
						<Text
							text="{localModel>codigoInsumo}"
							wrapping="false"
						/>
					</t:template>
				</t:Column>
				<t:Column width="auto">
					<Label text="{i18n>descripcion}"/>
					<t:template>
						<Text
							text="{localModel>descripcion}"
							wrapping="true"
						/>
					</t:template>
				</t:Column>
				<t:Column width="11rem">
					<Label text="{i18n>nroLote}"/>
					<t:template>
						<Text
							text="{localModel>lote}"
							wrapping="false"
						/>
					</t:template>
				</t:Column>
				<t:Column width="8rem">
					<Label text="{i18n>unidad}"/>
					<t:template>
						<Text
							text="{localModel>unidad}"
							wrapping="false"
						/>
					</t:template>
				</t:Column>
				<t:Column width="11rem">
					<Label text="{i18n>cantidadPesar}"/>
					<t:template>
						<Text
							text="{
								path: 'localModel>totalRequerido',
								formatter: '.formatter.peso'
							}"
							wrapping="false"
						/>
					</t:template>
				</t:Column>
				<t:Column width="10rem">
					<Label text="{i18n>cantPesada}"/>
					<t:template>
						<Text
							text="{
								path: 'localModel>totalAtendido',
								formatter: '.formatter.peso'
							}"
							wrapping="false"
						/>
					</t:template>
				</t:Column>
			</t:columns>
		</t:Table>
	</Page>
</mvc:View>